(self.webpackChunktp_spring_batch=self.webpackChunktp_spring_batch||[]).push([[3063],{727:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return p},metadata:function(){return m},toc:function(){return c},default:function(){return d}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),o=n(93456),l=["components"],s={sidebar_position:1},p="Mon premier Job",m={unversionedId:"tutorial-basics/first-job",id:"tutorial-basics/first-job",isDocsHomePage:!1,title:"Mon premier Job",description:"Objectifs",source:"@site/docs/tutorial-basics/first-job.md",sourceDirName:"tutorial-basics",slug:"/tutorial-basics/first-job",permalink:"/docusaurus-test/docs/tutorial-basics/first-job",editUrl:"https://github.com/GoroGoraK/docusaurus-test/docs/tutorial-basics/first-job.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Configuration Spring",permalink:"/docusaurus-test/docs/tutorial-init/spring-initialization"},next:{title:"DataSource",permalink:"/docusaurus-test/docs/tutorial-basics/datasource"}},c=[{value:"Objectifs",id:"objectifs",children:[{value:"Traitement cible",id:"traitement-cible",children:[]},{value:"Structure Physique",id:"structure-physique",children:[]}]},{value:"Pr\xe9ambule",id:"pr\xe9ambule",children:[]},{value:"Configuration YAML / Bundle (properties)",id:"configuration-yaml--bundle-properties",children:[]},{value:"Premi\xe8re Tasklet",id:"premi\xe8re-tasklet",children:[]},{value:"Premi\xe8re Step",id:"premi\xe8re-step",children:[]},{value:"Premier Job",id:"premier-job",children:[]},{value:"Test de l&#39;application",id:"test-de-lapplication",children:[{value:"M\xe9thode de lancement",id:"m\xe9thode-de-lancement",children:[]},{value:"Analyse de log",id:"analyse-de-log",children:[]}]},{value:"Conclusion",id:"conclusion",children:[]}],u={toc:c};function d(e){var t=e.components,n=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"mon-premier-job"},"Mon premier Job"),(0,r.kt)("h2",{id:"objectifs"},"Objectifs"),(0,r.kt)("p",null,"L'objectif de ce TP sera de cr\xe9er un ",(0,r.kt)("em",{parentName:"p"},"batch")," compos\xe9 d'une seule ",(0,r.kt)("em",{parentName:"p"},"Step")," elle m\xeame compos\xe9e d'une ",(0,r.kt)("em",{parentName:"p"},"Tasklet"),"."),(0,r.kt)("p",null,"Cette ",(0,r.kt)("em",{parentName:"p"},"Tasklet")," devra lire un fichier en entr\xe9e \xe0 partir d'un chemin absolu d\xe9fini dans le fichier de configuration de l'application et logguer son contenu dans la console."),(0,r.kt)("h3",{id:"traitement-cible"},"Traitement cible"),(0,r.kt)("p",null,"Voici le traitement \xe0 mettre en place."),(0,r.kt)(o.Mermaid,{chart:"stateDiagram-v2\n  direction LR\n  Traitement: Spring Batch Context\n  [*] --\x3e myFirstJob : 1\n  state Traitement {\n    direction LR\n    JobTraitement:  Job Execution Context _\n      state JobTraitement {\n        direction LR\n        myFirstJob --\x3e myFirstStep : 2\n        StepExecutionContext : Step Execution Context\n        state StepExecutionContext {\n          myFirstStep --\x3e myFirstTasklet : 3\n          note right of myFirstTasklet \n              Log le contenu d'un fichier \n              dans la console dans la console\n          end note\n        }\n      }\n    }\n    myFirstJob --\x3e [*] : 4",mdxType:"Mermaid"}),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Lancement de notre ",(0,r.kt)("em",{parentName:"li"},"Job")," via ",(0,r.kt)("em",{parentName:"li"},"Launcher")," ou ",(0,r.kt)("em",{parentName:"li"},"Command Line"),"."),(0,r.kt)("li",{parentName:"ol"},"Lancement de notre ",(0,r.kt)("em",{parentName:"li"},"Step")," via notre ",(0,r.kt)("em",{parentName:"li"},"Job"),"."),(0,r.kt)("li",{parentName:"ol"},"Lancement de note ",(0,r.kt)("em",{parentName:"li"},"Tasklet")," via notre ",(0,r.kt)("em",{parentName:"li"},"Step"),".",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"Log dans la console."))),(0,r.kt)("li",{parentName:"ol"},"Fin de traitement.")),(0,r.kt)("h3",{id:"structure-physique"},"Structure Physique"),(0,r.kt)("p",null,"Voici la structure \xe0 atteindre lors de cette partie :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:"{5-21}","{5-21}":!0},"\ud83d\udce6tutorial-spring-batch\n\u2523 \ud83d\udcc2src\n\u2503 \u2523 \ud83d\udcc2main\n\u2503 \u2503 \u2523 \ud83d\udcc2java\n\u2503 \u2503 \u2503 \u2517\ud83d\udd38fr.goro.tutorial.spring.batch\n\u2503 \u2503 \u2503   \u2503  \u2139\ufe0f Package racine du code source de l'application\n\u2503 \u2503 \u2503   \u2523\ud83d\udd38firstbatch\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2139\ufe0f Package racine de notre premier batch \n\u2503 \u2503 \u2503   \u2503 \u2523\ud83d\udd38config\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2503 \u2139\ufe0f Package contenant la d\xe9finition des @Bean Spring, les classes \xe0 d\xe9velopper ici sont suffix\xe9es du mode Configuration (ou Config)\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2523\ud83d\udd38step\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2503  \u2503 \u2139\ufe0f Package contenant la d\xe9finition  des @Bean Step\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2503  \u2517 \ud83d\udcdcFirstTaskletStepConfiguration.java\n\u2503 \u2503 \u2503   \u2503 \u2503  \u2517 \ud83d\udcdcFirstBatchConfiguration.java\n\u2503 \u2503 \u2503   \u2503 \u2517\ud83d\udd38tasklet\n\u2503 \u2503 \u2503   \u2503  \u2503 \u2139\ufe0f Package contenant la logique m\xe9tier des tasklets.\n\u2503 \u2503 \u2503   \u2503  \u2517 \ud83d\udcdcFirstTasklet.java\n\u2503 \u2503 \u2503   \u2517 \ud83d\udcdcTutorialSpringBatchApplication.java\n\u2503 \u2503 \u2517 \ud83d\udcc2resources\n\u2503 \u2503   \u2503 \u2139\ufe0f Resources de l'application\n\u2503 \u2503   \u2517 \ud83d\udcdcapplication.yml\n\u2503 \u2523 \ud83d\udcc2test\n\u2503 \u2503 \u2523 \ud83d\udcc2java\n\u2503 \u2503 \u2503  \u2139\ufe0f Code source des tests unitaires de l'application\n\u2503 \u2503 \u2517 \ud83d\udcc2resources\n\u2503 \u2503     \u2139\ufe0f Resources des tests unitaires (jeux de donn\xe9es,...)\n\u2503 \u2517 \ud83d\udcc2it\n\u2503   \u2523 \ud83d\udcc2java\n\u2503   \u2503   \u2139\ufe0f Code source des tests d'int\xe9gration\n\u2503   \u2517 \ud83d\udcc2resources\n\u2503       \u2139\ufe0f Resource des tests d'int\xe9gration (configuration Spring, ...)\n\u2517 \ud83d\udcdcpom.xml\n")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Attention")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"La structure de package pr\xe9sent\xe9e ici n'est qu'un exemple, il convient de l'adapter en fonction des clients / besoin."))),(0,r.kt)("h2",{id:"pr\xe9ambule"},"Pr\xe9ambule"),(0,r.kt)("p",null,"On retrouve dans le code source (",(0,r.kt)("inlineCode",{parentName:"p"},"src/main/java"),") deux sous packages principaux :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"config ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Il contiendra ",(0,r.kt)("strong",{parentName:"li"},"uniquement des m\xe9thodes permettant la d\xe9finition de ",(0,r.kt)("em",{parentName:"strong"},"@Bean")," ",(0,r.kt)("em",{parentName:"strong"},"Spring"))),(0,r.kt)("li",{parentName:"ul"},"Il pourra contenir des fichiers suffix\xe9s de ",(0,r.kt)("em",{parentName:"li"},"Configuration")," (ou ",(0,r.kt)("em",{parentName:"li"},"Config"),") pour la d\xe9finition des ",(0,r.kt)("em",{parentName:"li"},"@Bean")," et ",(0,r.kt)("em",{parentName:"li"},"Properties")," (ou ",(0,r.kt)("em",{parentName:"li"},"Property"),") pour la d\xe9finition d'objet de propri\xe9t\xe9s d\xe9finies dans l'",(0,r.kt)("em",{parentName:"li"},"application.yml")),(0,r.kt)("li",{parentName:"ul"},"Il ne contiendra aucune logique m\xe9tier, uniquement de la d\xe9finition de ",(0,r.kt)("em",{parentName:"li"},"@Bean")," / properties."),(0,r.kt)("li",{parentName:"ul"},"On s'appuiera autant que possible sur des ",(0,r.kt)("em",{parentName:"li"},"class")," ",(0,r.kt)("em",{parentName:"li"},"Spring")," afin de minimiser le code source \xe0 d\xe9velopper au sein des autres ",(0,r.kt)("em",{parentName:"li"},"package"))))),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Best Practice")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Ce package est la base de notre traitement, c'est dans ce package que nous d\xe9finirons les objets (",(0,r.kt)("inlineCode",{parentName:"li"},"@Bean"),") que ",(0,r.kt)("em",{parentName:"li"},"Spring Batch")," devra utiliser pour r\xe9aliser le traitement."),(0,r.kt)("li",{parentName:"ul"},"On utilise autant que possible des objets ",(0,r.kt)("em",{parentName:"li"},"Spring Batch")," pour d\xe9finir nos ",(0,r.kt)("inlineCode",{parentName:"li"},"@Bean"),".")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"tasklet",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Il contiendra uniquement le d\xe9veloppement m\xe9tier de nos ",(0,r.kt)("em",{parentName:"li"},"tasklets"),"."),(0,r.kt)("li",{parentName:"ul"},"Une ",(0,r.kt)("em",{parentName:"li"},"tasklet")," impl\xe9mente l'interface ",(0,r.kt)("em",{parentName:"li"},"Spring")," ",(0,r.kt)("inlineCode",{parentName:"li"},"Tasklet")," et est suffix\xe9e de ",(0,r.kt)("em",{parentName:"li"},"Tasklet"),".")))),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Bad Practice")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Ne jamais utiliser d'annotation dans une classe de traitement. Pour un batch ",(0,r.kt)("em",{parentName:"li"},"Spring"),", les annotations ne seront accept\xe9es que dans la classe main du batch, ainsi que dans le package ",(0,r.kt)("em",{parentName:"li"},"config"),".")))),(0,r.kt)("p",null,"Nous d\xe9couvrirons d'autres ",(0,r.kt)("em",{parentName:"p"},"package")," dans les diff\xe9rentes parties du tutoriel."),(0,r.kt)("h2",{id:"configuration-yaml--bundle-properties"},"Configuration YAML / Bundle (properties)"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Best Practice ")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Spring charge automatiquement les propri\xe9t\xe9s d\xe9clar\xe9es dans l'application.yml ou l'application.properties pr\xe9sent dans son ",(0,r.kt)("inlineCode",{parentName:"p"},"classpath"),", autant l'utiliser !"))),(0,r.kt)("p",null,"Commen\xe7ons par la configuration ",(0,r.kt)("em",{parentName:"p"},"YAML")," (au format YML). Nous allons y d\xe9clarer le chemin vers un fichier \xe0 lire."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="application.yml"',title:'"application.yml"'},"inputFile: /chemin/vers/fichier_traiter.txt\n")),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Attention")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Le chemin contenu dans la variable ",(0,r.kt)("inlineCode",{parentName:"p"},"inputFile")," doit \xeatre modifi\xe9. Vous pouvez cr\xe9er un dossier sp\xe9cifique pour ce tutorial, puis sous dossier pour ce batch (ex : ~/Documents/tutoriel",(0,r.kt)("em",{parentName:"p"},"springbatch/firstbatch"),")."))),(0,r.kt)("p",null,"Une fois le fichier cr\xe9\xe9, nous allons pouvoir cr\xe9er notre tasklet."),(0,r.kt)("h2",{id:"premi\xe8re-tasklet"},"Premi\xe8re Tasklet"),(0,r.kt)("p",null,"La tasklet lira simplement le contenu d'un fichier et le logguera en info (par d\xe9faut, dans la sortie standard : notre bonne vieille console !)."),(0,r.kt)("p",null,"Le traitement d'une t\xe2che type ",(0,r.kt)("em",{parentName:"p"},"Tasklet")," \xe9tant propre \xe0 un besoin pr\xe9cis, il n'existe pas d'impl\xe9mentation pr\xe9vu par le framework, de ce fait, une ",(0,r.kt)("em",{parentName:"p"},"tasklet")," doit d\xe9finir la m\xe9thode ",(0,r.kt)("em",{parentName:"p"},"execute")," de l'interface ",(0,r.kt)("inlineCode",{parentName:"p"},"Takslet"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("a",{class:"btnfire small stroke"},(0,r.kt)("em",{class:"fas fa-chevron-circle-down"},"Voir le code source"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="fr.goro.tutorial.spring.batch.firstbatch.tasklet.FirstTasklet.java"',title:'"fr.goro.tutorial.spring.batch.firstbatch.tasklet.FirstTasklet.java"'},'\npackage fr.goro.tutorial.spring.batch.firstbatch.tasklet;\n\nimport java.nio.file.Files;\nimport java.util.stream.Collectors;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.batch.core.StepContribution;\nimport org.springframework.batch.core.scope.context.ChunkContext;\nimport org.springframework.batch.core.step.tasklet.Tasklet;\nimport org.springframework.batch.repeat.RepeatStatus;\nimport org.springframework.core.io.Resource;\nimport org.springframework.util.Assert;\n\n/**\n * Classe Premi\xe8re Tasklet, elle ne fera que logguer le contenu d\'un fichier via log4j.\n */\npublic class FirstTasklet implements Tasklet {\n\n    /**\n     * Logger Slf4j/Logback (logger par d\xe9faut) de la classe {@link FirstTasklet}.\n     */\n    private static Logger LOGGER = LoggerFactory.getLogger(FirstTasklet.class);\n\n    /**\n     * Le fichier \xe0 traiter.\n     */\n    private final Resource inputFile;\n\n    /**\n     * Constructeur param\xe9tr\xe9 de MyFirstTasklet.\n     *\n     * @param inputFile le fichier \xe0 traiter.\n     */\n    public FirstTasklet(final Resource inputFile) {\n        Assert.notNull(inputFile, "Le fichier en entr\xe9e de la Tasklet ne peut \xeatre vide !");\n        this.inputFile = inputFile;\n    }\n\n    /**\n     * M\xe9thode de traitement de {@link FirstTasklet}.\n     *\n     * Cette m\xe9thode logguera uniquement le contenu du fichier pass\xe9 en param\xe9tre.\n     *\n     */\n    @Override\n    public RepeatStatus execute(final StepContribution contribution, final ChunkContext chunkContext) throws Exception {\n        LOGGER.info(Files.lines(inputFile.getFile().toPath()).collect(Collectors.joining("\\n")));\n        return RepeatStatus.FINISHED;\n    }\n}\n\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Utilisation du logguer par d\xe9faut (",(0,r.kt)("a",{parentName:"li",href:"https://logback.qos.ch/manual/introduction.html"},"logback")," via le ",(0,r.kt)("inlineCode",{parentName:"li"},"Logger")," de ",(0,r.kt)("a",{parentName:"li",href:"http://www.slf4j.org/manual.html"},(0,r.kt)("em",{parentName:"a"},"slf4j")),") en constante."),(0,r.kt)("li",{parentName:"ul"},"D\xe9claration d'une ",(0,r.kt)("inlineCode",{parentName:"li"},"Resource")," ",(0,r.kt)("em",{parentName:"li"},"Spring"),", le fichier sur lequel notre ",(0,r.kt)("em",{parentName:"li"},"Tasklet")," devra travailler."),(0,r.kt)("li",{parentName:"ul"},"Le constructeur prend en param\xe8tre le fichier en entr\xe9e, en bonne pratique ici, nous v\xe9rifions que la resource pass\xe9e en param\xe8tre est non ",(0,r.kt)("em",{parentName:"li"},"null"),". Pour ce genre de contr\xf4le technique,",(0,r.kt)("inlineCode",{parentName:"li"},"Assert")," de ",(0,r.kt)("em",{parentName:"li"},"Spring Batch")," fait tr\xe8s bien l'affaire."),(0,r.kt)("li",{parentName:"ul"},"L'impl\xe9mentation du code m\xe9tier de notre ",(0,r.kt)("em",{parentName:"li"},"Tasklet"),", ici: ",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Elle loggue en ",(0,r.kt)("em",{parentName:"li"},"info")," le contenu du fichier ",(0,r.kt)("inlineCode",{parentName:"li"},"Resource")," de notre ",(0,r.kt)("em",{parentName:"li"},"Tasklet"),"."),(0,r.kt)("li",{parentName:"ul"},"Elle indique qu'elle a termin\xe9 le traitement."))))))),(0,r.kt)("h2",{id:"premi\xe8re-step"},"Premi\xe8re Step"),(0,r.kt)("p",null,"Une ",(0,r.kt)("em",{parentName:"p"},"class")," de configuration ",(0,r.kt)("em",{parentName:"p"},"Spring")," est annot\xe9e d'une annotation ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"@Configuration"))," qui indique au framework de mettre \xe0 disposition du traitement les ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"@Bean"))," qui y sont d\xe9finis."),(0,r.kt)("p",null,"Une ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Step"))," est un ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"@Bean"))," de type ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Step")),", pour notre exemple ici, elle ne fera qu'ex\xe9cuter notre ",(0,r.kt)("em",{parentName:"p"},"tasklet"),"."),(0,r.kt)("p",null,"Une ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"tasklet"))," est un ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"@Bean"))," de type ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Tasklet")),", il s'agira de retourner une nouvelle instance de la ",(0,r.kt)("em",{parentName:"p"},"tasklet")," que nous avons d\xe9velopp\xe9 plus t\xf4t."),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("a",{class:"btnfire small stroke"},(0,r.kt)("em",{class:"fas fa-chevron-circle-down"},"Voir le code source"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="fr.goro.tutorial.spring.batch.firstbatch.config.step.FirstTaskletStepConfiguration.java"',title:'"fr.goro.tutorial.spring.batch.firstbatch.config.step.FirstTaskletStepConfiguration.java"'},'\npackage fr.goro.tutorial.spring.batch.firstbatch.config.step;\n\nimport org.springframework.batch.core.Step;\nimport org.springframework.batch.core.configuration.annotation.StepBuilderFactory;\nimport org.springframework.batch.core.step.tasklet.Tasklet;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.io.Resource;\n\nimport fr.goro.tutorial.spring.batch.firstbatch.tasklet.FirstTasklet;\n\n/**\n * Classe de configuration de notre premi\xe8re {@link Step} compos\xe9e d\'une {@link Tasklet} {@link FirstTasklet}.\n *\n */\n@Configuration\npublic class FirstTaskletStepConfiguration {\n\n    /**\n     * D\xe9finition de la step de lecture de fichier.\n     *\n     * @param stepBuilderFactory la factory de construction de {@link Step}.\n     * @param myFirstTasklet notre premi\xe8re {@link Tasklet} de lecture de fichier.\n     * @return notre premi\xe8re {@link Step} compos\xe9 de notre premi\xe8re {@link Tasklet}.\n     */\n    @Bean\n    public Step myFirstStep(final StepBuilderFactory stepBuilderFactory, final Tasklet myFirstTasklet) {\n        return stepBuilderFactory\n                .get("myFirstStep")\n                .tasklet(myFirstTasklet)\n                .build();\n    }\n\n    /**\n     * D\xe9finition de notre premi\xe8re {@link Tasklet} de lecture de fichier.\n     *\n     * @param directoryPath la {@link Resource} dont le path est issu du fichier de configuration.\n     * @return notre premi\xe8re {@link Tasklet} configur\xe9e.\n     */\n    @Bean\n    public Tasklet myFirstTasklet(@Value("${inputFile}") final Resource directoryPath) {\n        return new FirstTasklet(directoryPath);\n    }\n\n}\n\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Nous avons nomm\xe9 notre classe ",(0,r.kt)("em",{parentName:"li"},"FirstTaskletStep",(0,r.kt)("strong",{parentName:"em"},"Configuration"))," car elle contiendra la configuration de toute notre premi\xe8re ",(0,r.kt)("em",{parentName:"li"},"step"),". Il convient de nommer correctement les classes de configuration en se r\xe9f\xe9rant aux normes en vigueurs li\xe9es \xe0 votre environnement de d\xe9veloppement."),(0,r.kt)("li",{parentName:"ul"},"On y retrouve la d\xe9claration de deux ",(0,r.kt)("inlineCode",{parentName:"li"},"@Bean")," ",(0,r.kt)("strong",{parentName:"li"},"nomm\xe9 pr\xe9cis\xe9ment (nom de m\xe9thode)"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"myFirstStep"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"La m\xe9thode de d\xe9finition prend deux param\xe8tres :",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"un ",(0,r.kt)("inlineCode",{parentName:"li"},"StepBuilderFactory"),", notre constructeur de ",(0,r.kt)("em",{parentName:"li"},"step"),", il est inject\xe9 automatiquement par le framework."),(0,r.kt)("li",{parentName:"ul"},"une ",(0,r.kt)("inlineCode",{parentName:"li"},"Tasklet")," nomm\xe9 ",(0,r.kt)("em",{parentName:"li"},(0,r.kt)("strong",{parentName:"em"},"myFirstTasklet")),"."))),(0,r.kt)("li",{parentName:"ul"},"A partir de ces param\xe8tres, la factory cr\xe9\xe9 la ",(0,r.kt)("inlineCode",{parentName:"li"},"Step")," (compos\xe9 de la ",(0,r.kt)("em",{parentName:"li"},"tasklet"),", via ",(0,r.kt)("em",{parentName:"li"},".tasklet()"),") qu'il nommera ",(0,r.kt)("em",{parentName:"li"},"myFirstStep")," (",(0,r.kt)("em",{parentName:"li"},'get("myFirstStep")'),") dans son contexte."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"myFirstTasklet"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"La m\xe9thode de d\xe9finition prend un param\xe8tre :",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"une ",(0,r.kt)("inlineCode",{parentName:"li"},"Resource")," inject\xe9e automatiquement par le framework, qui se basera sur le path d\xe9fini dans la variable ",(0,r.kt)("em",{parentName:"li"},(0,r.kt)("strong",{parentName:"em"},"inputFile")),"."))))))))))),(0,r.kt)("h2",{id:"premier-job"},"Premier Job"),(0,r.kt)("p",null,"Il s'agit toujours d'une classe de configuration, elle sera donc annot\xe9e de ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"@Configuration"))," et contiendra la d\xe9finition de ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"@Bean"))),(0,r.kt)("p",null,"Un ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Job"))," est un ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"@Bean"))," de type ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"Job")),", pour notre exemple, il ne fera qu'ex\xe9cuter notre premi\xe8re ",(0,r.kt)("em",{parentName:"p"},"step"),"."),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("a",{class:"btnfire small stroke"},(0,r.kt)("em",{class:"fas fa-chevron-circle-down"}),"Voir la soluce")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="fr.goro.tutorial.spring.batch.firstbatch.config.FirstBatchConfiguration.java"',title:'"fr.goro.tutorial.spring.batch.firstbatch.config.FirstBatchConfiguration.java"'},'\npackage fr.goro.tutorial.spring.batch.firstbatch.config;\n\nimport org.springframework.batch.core.Job;\nimport org.springframework.batch.core.Step;\nimport org.springframework.batch.core.configuration.annotation.EnableBatchProcessing;\nimport org.springframework.batch.core.configuration.annotation.JobBuilderFactory;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * Configuration global du batch.\n */\n@Configuration\n@EnableBatchProcessing\npublic class FirstBatchConfiguration {\n\n    /**\n     * D\xe9finition de notre {@link Job}.\n     *\n     * @param jobBuilderFactory la factory de construction de {@link Job}\n     * @param myFirstStep notre premi\xe8re {@link Step} compos\xe9e de notre premi\xe8re tasklet.\n     * @return notre premier {@link Job} Spring Batch.\n     */\n    @Bean\n    public Job myFirstJob(final JobBuilderFactory jobBuilderFactory, final Step myFirstStep) {\n        return jobBuilderFactory.get("myFirstJob")\n                .start(myFirstJob)\n                .build();\n    }\n\n}\n\n')),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Nous avons nomm\xe9 notre classe ",(0,r.kt)("em",{parentName:"li"},"FirstBatch",(0,r.kt)("strong",{parentName:"em"},"Configuration"))," car elle contiendra uniquement la configuration de notre premi\xe8re traitement batch. Il convient de nommer correctement les classes de configuration en se r\xe9f\xe9rant aux normes en vigueurs li\xe9es \xe0 votre environnement de d\xe9veloppement."),(0,r.kt)("li",{parentName:"ul"},"On y retrouve la d\xe9claration d'un ",(0,r.kt)("inlineCode",{parentName:"li"},"@Bean")," ",(0,r.kt)("strong",{parentName:"li"},"nomm\xe9 pr\xe9cis\xe9ment (nom de m\xe9thode)"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"myFirstJob"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"La m\xe9thode de d\xe9finition prend deux param\xe8tres :",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"un ",(0,r.kt)("inlineCode",{parentName:"li"},"JobBuilderFactory"),", notre constructeur de ",(0,r.kt)("em",{parentName:"li"},"job"),", il est inject\xe9 automatiquement par le framework."),(0,r.kt)("li",{parentName:"ul"},"une ",(0,r.kt)("inlineCode",{parentName:"li"},"Step")," nomm\xe9 ",(0,r.kt)("em",{parentName:"li"},(0,r.kt)("strong",{parentName:"em"},"myFirstStep")),"."))),(0,r.kt)("li",{parentName:"ul"},"A partir de ces param\xe8tres, la factory cr\xe9\xe9 le ",(0,r.kt)("inlineCode",{parentName:"li"},"Job")," qu'il nommera ",(0,r.kt)("em",{parentName:"li"},"myFirstJob")," (",(0,r.kt)("em",{parentName:"li"},'get("myFirstJob")'),") dans son contexte."))))))))),(0,r.kt)("p",null,"Et voila tout ! Notre premier ",(0,r.kt)("em",{parentName:"p"},"Job")," est termin\xe9 ! Nous pouvons d\xe9sormais tester son lancement en local."),(0,r.kt)("h2",{id:"test-de-lapplication"},"Test de l'application"),(0,r.kt)("h3",{id:"m\xe9thode-de-lancement"},"M\xe9thode de lancement"),(0,r.kt)("p",null,"Plusieurs m\xe9thodes de lancement sont possibles :"),(0,r.kt)("h4",{id:"terminal"},"Terminal"),(0,r.kt)("p",null,"Via un terminal, depuis votre workspace, vous pouvez taper :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Lancement de l'application :")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"java -jar target/tutorial-spring-batch-0.0.1-SNAPSHOT.jar\n")),(0,r.kt)("p",null,"De cette mani\xe8re, ",(0,r.kt)("em",{parentName:"p"},"Spring")," lancera l'ensemble des ",(0,r.kt)("em",{parentName:"p"},"Job")," qu'il trouvera."),(0,r.kt)("p",null,"Pour les besoins du TP, nous utiliserons le ",(0,r.kt)("em",{parentName:"p"},"CommandLineRunner")," propos\xe9 par ",(0,r.kt)("em",{parentName:"p"},"Spring Batch"),", il nous permettra de lancer notre batch en pr\xe9cisant le fichier de configuration ",(0,r.kt)("em",{parentName:"p"},"Java")," utilis\xe9 et le nom du ",(0,r.kt)("em",{parentName:"p"},"Job")," \xe0 lancer.\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-batch/docs/current/reference/html/index-single.html#runningJobsFromCommandLine"},"La documentation officiel de ",(0,r.kt)("inlineCode",{parentName:"a"},"Spring")," \xe0 ce sujet")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"java -jar target/tutorial-spring-batch-0.0.1-SNAPSHOT.jar CommandLineJobRunner fr.goro.tutorial.spring.batch.firstbatch.config.FirstBatchConfiguration myFirstJob\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell-session"},"$ ls\nsome output\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},"foo@bar:~$ whoami\nfoo\n")),(0,r.kt)("h4",{id:"launcher"},"Launcher"),(0,r.kt)("p",null,"La majorit\xe9 des IDE propose diff\xe9rent Launcher permettant de lancer des applications, au choix :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Java Application."),(0,r.kt)("li",{parentName:"ul"},"Spring Boot App (d\xe9pend g\xe9n\xe9ralement d'un plugin suppl\xe9mentaire relatif \xe0 l'IDE utilis\xe9).")),(0,r.kt)("p",null,"Pour les besoins du TP, nous utiliserons le ",(0,r.kt)("inlineCode",{parentName:"p"},"CommandLineRunner"),", pensez donc \xe0 ajouter ce qui suit en argument de votre Launcher :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Param\xe9tre de Launcher"',title:'"Param\xe9tre',de:!0,'Launcher"':!0},"CommandLineJobRunner fr.goro.tutorial.spring.batch.firstbatch.config.FirstBatchConfiguration myFirstJob\n")),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Bonne Pratique")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Prenez le temps de configurer correctement votre IDE lorsque vous \xe9tes amen\xe9s \xe0 travailler sur un m\xeame sujet :"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Utilisez un maximum de launcher pr\xe9 configur\xe9."),(0,r.kt)("li",{parentName:"ul"},"Nommez les correctement pour les retrouver facilement."),(0,r.kt)("li",{parentName:"ul"},"Configur\xe9 des launchers en favori sur vos sujets les plus r\xe9currents.")),(0,r.kt)("p",{parentName:"div"},"Ici, on pourrait imaginer "),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"un launcher ",(0,r.kt)("em",{parentName:"li"},"Maven")," pour ex\xe9cuter un ",(0,r.kt)("em",{parentName:"li"},"mvn clean install")," en favori."),(0,r.kt)("li",{parentName:"ul"},"un launcher ",(0,r.kt)("em",{parentName:"li"},"Spring Boot")," pour ex\xe9cuter une application ",(0,r.kt)("em",{parentName:"li"},"Spring"),"."),(0,r.kt)("li",{parentName:"ul"},"un launcher ",(0,r.kt)("em",{parentName:"li"},"Java")," pour ex\xe9cuter un ",(0,r.kt)("em",{parentName:"li"},"java -jar"),".")))),(0,r.kt)("h3",{id:"analyse-de-log"},"Analyse de log"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text",metastring:'{11,12,13,14} title="R\xe9sultat de la commande"',"{11,12,13,14}":!0,title:'"R\xe9sultat',de:!0,la:!0,'commande"':!0},"\n  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::                (v2.5.4)\n\nINFO 192067 --- [           main] f.g.t.s.b.TutorialSpringBatchApplication : Starting TutorialSpringBatchApplication using Java 11.0.11 on goro-XPS-15-9560 with PID 192067 (/home/goro/Documents/workspace/tutorial-spring-batch/target/classes started by goro in /home/goro/Documents/workspace/tutorial-spring-batch)\nINFO 192067 --- [           main] f.g.t.s.b.TutorialSpringBatchApplication : No active profile set, falling back to default profiles: default\nINFO 192067 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...\nINFO 192067 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.\nINFO 192067 --- [           main] o.s.b.c.r.s.JobRepositoryFactoryBean     : No database type set, using meta data indicating: H2\nINFO 192067 --- [           main] o.s.b.c.l.support.SimpleJobLauncher      : No TaskExecutor has been set, defaulting to synchronous executor.\nINFO 192067 --- [           main] f.g.t.s.b.TutorialSpringBatchApplication : Started TutorialSpringBatchApplication in 5.969 seconds (JVM running for 7.069)\nINFO 192067 --- [           main] o.s.b.a.b.JobLauncherApplicationRunner   : Running default command line with: [CommandLineJobRunner, fr.goro.tutorial.spring.batch.firstbatch.config.FirstBatchConfiguration, myFirstJob]\nINFO 192067 --- [           main] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=myFirstJob]] launched with the following parameters: [{}]\nINFO 192067 --- [           main] o.s.batch.core.job.SimpleStepHandler     : Executing step: [readFile]\nINFO 192067 --- [           main] f.g.t.s.b.f.tasklet.FirstTasklet         : Contenu du fichier affichier par My First Tasklet\n\n####### ######            #####  ######  ######  ### #     #  #####     ######     #    #######  #####  #     #\n   #    #     #          #     # #     # #     #  #  ##    # #     #    #     #   # #      #    #     # #     #\n   #    #     #          #       #     # #     #  #  # #   # #          #     #  #   #     #    #       #     #\n   #    ######            #####  ######  ######   #  #  #  # #  ####    ######  #     #    #    #       #######\n   #    #                      # #       #   #    #  #   # # #     #    #     # #######    #    #       #     #\n   #    #                #     # #       #    #   #  #    ## #     #    #     # #     #    #    #     # #     #\n   #    #                 #####  #       #     # ### #     #  #####     ######  #     #    #     #####  #     #\n\n\n\n\n               #####\n\n\n\n\n#     # #     #    ####### ### ######   #####  #######    #######    #     #####  #    # #       ####### #######\n##   ##  #   #     #        #  #     # #     #    #          #      # #   #     # #   #  #       #          #\n# # # #   # #      #        #  #     # #          #          #     #   #  #       #  #   #       #          #\n#  #  #    #       #####    #  ######   #####     #          #    #     #  #####  ###    #       #####      #\n#     #    #       #        #  #   #         #    #          #    #######       # #  #   #       #          #\n#     #    #       #        #  #    #  #     #    #          #    #     # #     # #   #  #       #          #\n#     #    #       #       ### #     #  #####     #          #    #     #  #####  #    # ####### #######    #\nINFO 192067 --- [           main] o.s.batch.core.step.AbstractStep         : Step: [readFile] executed in 47ms\nINFO 192067 --- [           main] o.s.b.c.l.support.SimpleJobLauncher      : Job: [SimpleJob: [name=myFirstJob]] completed with the following parameters: [{}] and the following status: [COMPLETED] in 99ms\nINFO 192067 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...\nINFO 192067 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.\n\n")),(0,r.kt)("p",null,"En regardant de plus pr\xe8s les log (lignes surlign\xe9es) de notre application, on remarque plusieurs choses :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Aucun profil n'est utilis\xe9, il utilise donc celui par d\xe9faut (notre ",(0,r.kt)("inlineCode",{parentName:"p"},"application.yml"),");")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Il demarre avec succ\xe9s une base de donn\xe9es H2 (alors qu'on ne lui a rien dit \ud83d\ude12);")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Le batch a bien lanc\xe9 le job (sans param\xe9tre \xe0 priori), qui a lui m\xeame lanc\xe9 la tasklet;")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Le bactch a termin\xe9 \xe0 l'\xe9tat COMPLETED"))),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"Nous avons d\xe9sormais un premier ",(0,r.kt)("em",{parentName:"p"},"Spring Batch")," fonctionnel, que nous savons tester \xe0 la main de diff\xe9rente mani\xe8re. "),(0,r.kt)("p",null,"Interessons-nous maintenant \xe0 cette myst\xe9rieuse datasource."))}d.isMDXComponent=!0},11748:function(e,t,n){var a={"./locale":89234,"./locale.js":89234};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=11748}}]);